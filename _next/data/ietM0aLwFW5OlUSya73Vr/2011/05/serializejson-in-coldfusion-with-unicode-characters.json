{"pageProps":{"post":{"year":"2011","month":"05","day":"17","slug":"serializejson-in-coldfusion-with-unicode-characters","filename":"2011-05-17-serializejson-in-coldfusion-with-unicode-characters.md","html":"<p>This weekend I read an interesting blog post called <a href=\"http://timelessrepo.com/json-isnt-a-javascript-subset\">JSON: The JavaScript subset that isn't</a>\nand decided to test ColdFusion's SerializeJSON() function to see if the \"bug\" existed there.\nIt does. To reproduce, you can create a .cfm page that contains the following HTML/CF code:</p>\n<pre><code class=\"hljs language-cfm\">&lt;script type=\"text/javascript\"&gt;\n    var test = #SerializeJSON(\"test\" &amp; chr(8232))#;\n&lt;/script&gt;\n</code></pre>\n<p>To \"fix\" the bug, you can replace SerializeJSON() with SafeSerializeJSON() like this:</p>\n<pre><code class=\"hljs language-cfm\">&lt;script type=\"text/javascript\"&gt;\n    var test = #SafeSerializeJSON(\"test\" &amp; chr(8232))#;\n&lt;/script&gt;\n</code></pre>\n<p>The SafeSerializeJSON() function looks like this:</p>\n<pre><code class=\"hljs language-cfm\">&lt;cffunction name=\"SafeSerializeJSON\" output=\"false\" access=\"private\" returntype=\"string\"&gt;\n    &lt;cfargument name=\"obj\" type=\"any\" required=\"true\" /&gt;\n    &lt;cfargument name=\"serializeQueryByColumns\" type=\"boolean\" required=\"false\" default=\"false\" /&gt;\n    &lt;cfset var jsonOutput = SerializeJSON(arguments.obj, arguments.serializeQueryByColumns) /&gt;\n    &lt;cfset jsonOutput = Replace(jsonOutput, chr(8232), \"\\u2028\", \"all\") /&gt;\n    &lt;cfset jsonOutput = Replace(jsonOutput, chr(8233), \"\\u2029\", \"all\") /&gt;\n    &lt;cfreturn jsonOutput /&gt;\n&lt;/cffunction&gt;\n</code></pre>\n<p>I've created a <a href=\"https://gist.github.com/975802\">gist</a> that explores the issue in slightly more detail:</p>\n<ul>\n<li><a href=\"https://gist.github.com/975802#file_json.cfm\">json.cfm</a></li>\n<li><a href=\"https://gist.github.com/975802#file_json2.cfm\">json2.cfm</a></li>\n</ul>\n","frontmatter":{"layout":"post","title":"SerializeJSON() in ColdFusion with Unicode Characters","categories":["ColdFusion"],"tags":["ColdFusion","Javascript"]}},"previousTitle":"Open Electribe Editor - v1.0.2 Released","previousUrl":"/2011/03/open-electribe-editor-v1-0-2-released","nextTitle":"Git Diff Build Script (AKA read your Git docs)","nextUrl":"/2011/06/git-diff-build-script-aka-read-your-git-docs"},"__N_SSG":true}