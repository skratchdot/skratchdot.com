<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>MongoDB - schema.js &raquo; skratchdot.com</title>
    <!--
	  _                 _              _       _         _       _                 _
	 | |               | |            | |     | |       | |     | |               | |
	/ __)           ___| | ___ __ __ _| |_ ___| |__   __| | ___ | |_             / __)
	\__ \          / __| |/ / '__/ _` | __/ __| '_ \ / _` |/ _ \| __|            \__ \
	(   /          \__ \   <| | | (_| | || (__| | | | (_| | (_) | |_ _           (   /
	 |_|           |___/_|\_\_|  \__,_|\__\___|_| |_|\__,_|\___/ \__(_)           |_|

	                   wasting bytes with ascii art since [random date]
	-->
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/images/favicons/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/images/favicons/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/images/favicons/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="/images/favicons/apple-touch-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/images/favicons/apple-touch-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/images/favicons/apple-touch-icon-76x76.png"
    />
    <meta name="apple-mobile-web-app-title" content="skratchdot" />
    <link
      rel="icon"
      type="image/png"
      href="/images/favicons/favicon-96x96.png"
      sizes="96x96"
    />
    <link
      rel="icon"
      type="image/png"
      href="/images/favicons/favicon-16x16.png"
      sizes="16x16"
    />
    <link
      rel="icon"
      type="image/png"
      href="/images/favicons/favicon-32x32.png"
      sizes="32x32"
    />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="application-name" content="skratchdot" />
    <meta name="generator" content="Jekyll" />
    <link
      rel="alternate"
      type="application/atom+xml"
      title="Skratchdot (Atom 0.3)"
      href="/atom.xml"
    />
    <!-- Stylesheets -->
    <link
      rel="stylesheet"
      type="text/css"
      media="all"
      href="/css/html5reset-1.6.1.css?201804141145"
    />
    <link
      rel="stylesheet"
      type="text/css"
      media="screen"
      href="/css/style.css?201804141145"
    />
    <link
      rel="stylesheet"
      type="text/css"
      media="screen"
      href="/css/pygments.css?201804141145"
    />
    <!--[if lt IE 9]>
      <script
        type="text/javascript"
        src="//html5shiv.googlecode.com/svn/trunk/html5.js"
      ></script>
    <![endif]-->
    <script
      type="text/javascript"
      src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"
    ></script>
    <!-- Allow $.getScript() calls to be cached -->
    <script type="text/javascript">
      $.ajaxSetup({
        cache: true,
      });
    </script>
  </head>
  <body>
    <div class="hrRed"></div>
    <div class="hrBlack"></div>
    <header class="oneColumn">
      <h1><a href="/">&#91;skratchdot<span>.</span>&#93;</a></h1>
    </header>
    <nav id="mainNav" class="oneColumn">
      <ul>
        <li>
          <a title="Home" href="/"><span>&#91;</span>Home<span>&#93;</span></a>
        </li>
        <!--<li><a title="Browse" href="/browse/"><span>&#91;</span>Browse<span>&#93;</span></a></li>-->
        <li>
          <a title="Projects" href="/projects/"
            ><span>&#91;</span>Projects<span>&#93;</span></a
          >
        </li>
        <li>
          <a title="Contact" href="/contact/"
            ><span>&#91;</span>Contact<span>&#93;</span></a
          >
        </li>
      </ul>
    </nav>
    <!-- Social Buttons -->
    <div id="share-buttons-container">
      <ul class="share-buttons">
        <li>
          <a
            href="https://www.facebook.com/sharer/sharer.php?u=https://www.skratchdot.com/projects/mongodb-schema/&t=MongoDB%20-%20schema.js"
            title="Share on Facebook"
            target="_blank"
            ><img alt="Share on Facebook" src="/images/social/Facebook.png"
          /></a>
        </li>
        <li>
          <a
            href="https://twitter.com/intent/tweet?source=https://www.skratchdot.com/projects/mongodb-schema/&text=MongoDB%20-%20schema.js:%20https://www.skratchdot.com/projects/mongodb-schema/&via=skratchdot"
            target="_blank"
            title="Tweet"
            ><img alt="Tweet" src="/images/social/Twitter.png"
          /></a>
        </li>
        <li>
          <a
            href="https://plus.google.com/share?url=https://www.skratchdot.com/projects/mongodb-schema/"
            target="_blank"
            title="Share on Google+"
            ><img alt="Share on Google+" src="/images/social/Google+.png"
          /></a>
        </li>
        <li>
          <a
            href="https://www.tumblr.com/share?v=3&u=https://www.skratchdot.com/projects/mongodb-schema/&t=MongoDB%20-%20schema.js&s="
            target="_blank"
            title="Post to Tumblr"
            ><img alt="Post to Tumblr" src="/images/social/Tumblr.png"
          /></a>
        </li>
        <li>
          <a
            href="https://pinterest.com/pin/create/button/?url=https://www.skratchdot.com/projects/mongodb-schema/&description=MongoDB%20-%20schema.js%20Project%20Page%20Source%20Code%20Issues%20Description:%20This%20is%20a%20schema%20analysis%20tool%20for%20MongoDB.%20It%20accomplishes%20this%20by%20extending%20the%20mongo%20shell,%20and%20providing%20a%20new%20function%20called%20schema()%20with%20the%20following%20signature:%20DBCollection.prototype.schema%20=%20function%20(optionsOrOutString)%20The%20schema()%20function%20accepts%20all%20the%20same%20parameters%20that%20the..."
            target="_blank"
            title="Pin it"
            ><img alt="Pin it" src="/images/social/Pinterest.png"
          /></a>
        </li>
        <li>
          <a
            href="https://getpocket.com/save?url=https://www.skratchdot.com/projects/mongodb-schema/&title=MongoDB%20-%20schema.js"
            target="_blank"
            title="Add to Pocket"
            ><img alt="Add to Pocket" src="/images/social/Pocket.png"
          /></a>
        </li>
        <li>
          <a
            href="https://www.reddit.com/submit?url=https://www.skratchdot.com/projects/mongodb-schema/&title=MongoDB%20-%20schema.js"
            target="_blank"
            title="Submit to Reddit"
            ><img alt="Submit to Reddit" src="/images/social/Reddit.png"
          /></a>
        </li>
        <li>
          <a
            href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.skratchdot.com/projects/mongodb-schema/&title=MongoDB%20-%20schema.js&summary=MongoDB%20-%20schema.js%20Project%20Page%20Source%20Code%20Issues%20Description:%20This%20is%20a%20schema%20analysis%20tool%20for%20MongoDB.%20It%20accomplishes%20this%20by%20extending%20the%20mongo%20shell,%20and%20providing%20a%20new%20function%20called%20schema()%20with%20the%20following%20signature:%20DBCollection.prototype.schema%20=%20function%20(optionsOrOutString)%20The%20schema()%20function%20accepts%20all%20the%20same%20parameters%20that%20the...&source=https://www.skratchdot.com/projects/mongodb-schema/"
            target="_blank"
            title="Share on LinkedIn"
            ><img alt="Share on LinkedIn" src="/images/social/LinkedIn.png"
          /></a>
        </li>
        <li>
          <a
            href="mailto:?subject=MongoDB%20-%20schema.js&body=MongoDB%20-%20schema.js%20Project%20Page%20Source%20Code%20Issues%20Description:%20This%20is%20a%20schema%20analysis%20tool%20for%20MongoDB.%20It%20accomplishes%20this%20by%20extending%20the%20mongo%20shell,%20and%20providing%20a%20new%20function%20called%20schema()%20with%20the%20following%20signature:%20DBCollection.prototype.schema%20=%20function%20(optionsOrOutString)%20The%20schema()%20function%20accepts%20all%20the%20same%20parameters%20that%20the...:%20https://www.skratchdot.com/projects/mongodb-schema/"
            title="Send email"
            ><img alt="Send email" src="/images/social/Email.png"
          /></a>
        </li>
      </ul>
    </div>

    <section class="oneColumn">
      <article>
        <div class="entry">
          <h1 id="mongodb---schemajs">MongoDB - schema.js</h1>

          <p>
            <a href="https://www.skratchdot.com/projects/mongodb-schema/"
              >Project Page</a
            ><br />
            <a href="https://github.com/skratchdot/mongodb-schema/"
              >Source Code</a
            ><br />
            <a href="https://github.com/skratchdot/mongodb-schema/issues/"
              >Issues</a
            >
          </p>

          <h2 id="description">Description:</h2>

          <p>
            This is a schema analysis tool for MongoDB. It accomplishes this by
            extending the mongo shell, and providing a new function called
            schema() with the following signature:
          </p>

          <figure class="highlight">
            <pre><code class="language-javascript" data-lang="javascript"><span></span><span class="nx">DBCollection</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">schema</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">optionsOrOutString</span><span class="p">)</span>  </code></pre>
          </figure>

          <p>
            The schema() function accepts all the same parameters that the
            mapReduce() function does. It adds/modifies the following 4
            parameters that can be used as well:
          </p>

          <pre><code>wildcards - array (default: [])
    By using the $, you can combine report results.
    For instance: '$' will group all top level keys and
    'foo.$.bar' will combine 'foo.baz.bar' and 'foo.bar.bar'

arraysAreWildcards - boolean (default: true)
    When true, 'foo.0.bar' and 'foo.1.bar' will be
    combined into 'foo.$.bar'
    When false, all array keys will be reported

fields - object (default: {})
    Similar to the usage in find(). You can pick the
    fields to include or exclude. Currently, you cannot 
    pass in nested structures, you need to pass in dot notation keys.

limit - number (default: 50)
    Behaves the same as the limit in mapReduce(), but defaults to 50.
    You can pass in 0 or -1 to process all documents.
</code></pre>

          <h2 id="usage">Usage:</h2>

          <figure class="highlight">
            <pre><code class="language-javascript" data-lang="javascript"><span></span><span class="c1">// Return schema results inline</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">();</span>

<span class="c1">// Create and store schema results in the &#39;users_schema&#39; collection</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">(</span><span class="s1">&#39;users_schema&#39;</span><span class="p">);</span> <span class="c1">// Option 1</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">out</span><span class="o">:</span><span class="s1">&#39;users_schema&#39;</span><span class="p">});</span> <span class="c1">// Option 2</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">out</span><span class="o">:</span><span class="p">{</span><span class="nx">replace</span><span class="o">:</span><span class="s1">&#39;users_schema&#39;</span><span class="p">}});</span> <span class="c1">// Option 3</span>

<span class="c1">// Only report on the key: &#39;name.first&#39;</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">fields</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;name.first&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">}});</span>

<span class="c1">// Report on everything except &#39;name.first&#39;</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">fields</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;name.first&#39;</span><span class="o">:-</span><span class="mi">1</span><span class="p">}});</span>

<span class="c1">// Combine the &#39;name.first&#39; and &#39;name.last&#39; keys into &#39;name.$&#39;</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">wildcards</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;name.$&#39;</span><span class="p">]});</span>

<span class="c1">// Don&#39;t treat arrays as a wildcard</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">arraysAreWildcards</span><span class="o">:</span><span class="kc">false</span><span class="p">});</span>

<span class="c1">// Process 50 documents</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">();</span>

<span class="c1">// Process all documents</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">({</span><span class="nx">limit</span><span class="o">:-</span><span class="mi">1</span><span class="p">});</span></code></pre>
          </figure>

          <h2 id="example-result-set">Example Result Set:</h2>

          <figure class="highlight">
            <pre><code class="language-javascript" data-lang="javascript"><span></span><span class="o">&gt;</span> <span class="c1">// Start fresh with a new collection called &#39;users&#39;</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
<span class="o">&gt;</span> 
<span class="o">&gt;</span> <span class="c1">// Add a few records with different schemas</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span> <span class="o">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span> <span class="o">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">},</span> <span class="s1">&#39;isRegistered&#39;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span> <span class="o">:</span> <span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">]});</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span> <span class="o">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span> <span class="o">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">},</span> <span class="s1">&#39;isRegistered&#39;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span> <span class="o">:</span> <span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="s1">&#39;new&#39;</span><span class="p">]});</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span> <span class="o">:</span> <span class="s1">&#39;Amy&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span> <span class="o">:</span> <span class="s1">&#39;Smart&#39;</span><span class="p">},</span> <span class="s1">&#39;isRegistered&#39;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span> <span class="o">:</span> <span class="p">[</span><span class="s1">&#39;female&#39;</span><span class="p">]});</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="s1">&#39;name&#39;</span> <span class="o">:</span> <span class="s1">&#39;Bob Smith&#39;</span><span class="p">,</span> <span class="s1">&#39;isRegistered&#39;</span> <span class="o">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span> <span class="o">:</span> <span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">]});</span>
<span class="o">&gt;</span> 
<span class="o">&gt;</span> <span class="c1">// Print our results to the console</span>
<span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">schema</span><span class="p">();</span>
<span class="nx">Processing</span> <span class="mi">4</span> <span class="nb">document</span><span class="p">(</span><span class="nx">s</span><span class="p">)...</span>
<span class="p">{</span>
  <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;objectid&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;objectid&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;isRegistered&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;boolean&quot;</span><span class="p">,</span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="s2">&quot;string&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">50</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">25</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">25</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;bson&quot;</span><span class="p">,</span><span class="s2">&quot;string&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;bson&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">75</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">25</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;name.first&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">75</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">75</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;name.last&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">75</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">75</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;array&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;tags.$&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;wildcard&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">&quot;types&quot;</span> <span class="o">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">],</span>
        <span class="s2">&quot;results&quot;</span> <span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mf">1.25</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="s2">&quot;docs&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;coverage&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span><span class="s2">&quot;perDoc&quot;</span> <span class="o">:</span> <span class="mf">1.25</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;timeMillis&quot;</span> <span class="o">:</span> <span class="mi">16</span><span class="p">,</span>
  <span class="s2">&quot;counts&quot;</span> <span class="o">:</span> <span class="p">{</span><span class="s2">&quot;input&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span><span class="s2">&quot;emit&quot;</span> <span class="o">:</span> <span class="mi">26</span><span class="p">,</span><span class="s2">&quot;reduce&quot;</span> <span class="o">:</span> <span class="mi">7</span><span class="p">,</span><span class="s2">&quot;output&quot;</span> <span class="o">:</span> <span class="mi">7</span><span class="p">},</span>
  <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span></code></pre>
          </figure>

          <h2 id="caveats">Caveats:</h2>

          <p>
            By design, schema() returns ‘bson’ rather than ‘object’. It will
            return ‘numberlong’ rather than ‘number’, etc.
          </p>

          <h2 id="installation">Installation:</h2>

          <p>
            Download:
            <a
              href="https://github.com/skratchdot/mongodb-schema/raw/master/schema.js"
              >schema.js</a
            >
          </p>

          <h3 id="option-1">Option 1</h3>

          <p>Add this script to your .mongorc.js file.</p>

          <p>
            See:
            <a
              href="http://www.mongodb.org/display/DOCS/Overview+-+The+MongoDB+Interactive+Shell#Overview-TheMongoDBInteractiveShell-.mongorc.js"
              >http://www.mongodb.org/display/DOCS/Overview+-+The+MongoDB+Interactive+Shell#Overview-TheMongoDBInteractiveShell-.mongorc.js</a
            >
          </p>

          <h3 id="option-2">Option 2</h3>

          <p>Start the shell after executing this script</p>

          <pre><code>mongo --shell schema.js
</code></pre>

          <h2 id="inspired-by">Inspired by:</h2>

          <p>
            Variety:
            <a href="https://github.com/JamesCropcho/variety"
              >https://github.com/JamesCropcho/variety</a
            >
          </p>
        </div>

        <div>
          <br />
          <div style="border-bottom: 1px dotted"></div>
          <br />
        </div>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_shortname = 'skratchdot';
          var disqus_identifier = '/projects/mongodb-schema/';
          var disqus_url =
            'https://www.skratchdot.com/projects/mongodb-schema/';

          $.getScript('//' + disqus_shortname + '.disqus.com/embed.js');
        </script>
        <noscript
          >Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript"
            >comments powered by Disqus.</a
          ></noscript
        >
        <a href="https://disqus.com" class="dsq-brlink"
          >blog comments powered by <span class="logo-disqus">Disqus</span></a
        >
      </article>
      <nav id="articlesNav">
        <div>
          <div class="newEntries"></div>
          <div class="oldEntries"></div>
        </div>
        <div class="homeEntries"><a href="/">HOME</a></div>
      </nav>
    </section>
    <div class="footerSpacer"><br /></div>
    <footer class="oneColumn">
      <div>
        Copyright &#169; 2018 <a href="/">skratchdot</a>
        <span class="hspace">&#x2022;</span>
        Validate:&#160;&#160;
        <a href="https://validator.w3.org/check/referer">HTML5</a>
        <span class="hspace">&#x2022;</span>
        <a class="noBorder" href="/atom.xml"
          ><img
            src="/images/feed-icon-14x14.png"
            alt="RSS/Atom Feed"
            style="top: 2px"
        /></a>
        <span class="hspace">&#x2022;</span>
        <div class="twitter-button">
          <a
            class="twitter-button-link"
            href="https://twitter.com/intent/user?screen_name=skratchdot"
            target="_blank"
            aria-label="Follow @skratchdot on Twitter"
            title="Follow @skratchdot on Twitter"
          >
            <i></i>
            <span> Follow <b>@skratchdot</b> </span>
          </a>
        </div>
      </div>
    </footer>
    <a href="https://github.com/skratchdot" class="github-corner">
      <svg
        width="80"
        height="80"
        viewBox="0 0 250 250"
        style="
          fill: #c80000;
          color: #000;
          position: absolute;
          top: 0;
          border: 0;
          right: 0;
        "
      >
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor"
          style="transform-origin: 130px 106px"
          class="octo-arm"
        ></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor"
          class="octo-body"
        ></path>
        <path d="M10,10 L115,115 L250,250 Z" stroke="black" stroke-width="6" />
      </svg>
    </a>
    <div id="homepage_link">
      <a href="/" style="border: 0"
        ><img src="/favicon.ico" alt="skratchdot" width="16" height="16"
      /></a>
    </div>
    <!-- Javascript -->
    <script
      type="text/javascript"
      src="/js/skratchdot.js?201804141145"
    ></script>
    <!-- Google Analytics -->
    <script type="text/javascript">
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        (i[r] =
          i[r] ||
          function () {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        'script',
        '//www.google-analytics.com/analytics.js',
        'ga'
      );
      ga('create', 'UA-10768188-1', 'skratchdot.com');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </body>
</html>
